{% extends "layout_creditos.html" %}
{% load humanize %}
{% block title %} Buscar Veh√≠culo | Sistema de Cr√©ditos {% endblock %}

{% block content %}

<style>
    .titulo-financiera {
        font-weight: 700;
        color: #2c3e50;
    }
    .card-financiera {
        border-radius: 12px;
        border: none;
        background: white;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    .btn-financiera {
        background: #0d6efd;
        color: white;
        border-radius: 6px;
    }
    .btn-financiera:hover {
        background: #084298;
        color: white;
    }
</style>

<div class="container">

    <h2 class="titulo-financiera mb-4">üîç Buscar Veh√≠culo</h2>

    <!-- Formulario -->
    <form method="get" class="row g-3 mb-4">
        <div class="col-md-4">
            <input 
                type="text" 
                name="placa" 
                class="form-control form-control-lg"
                value="{{ placa }}"
                placeholder="Digite la placa del veh√≠culo">
        </div>
        <div class="col-md-2">
            <button class="btn btn-financiera w-100 btn-lg">Buscar</button>
        </div>
    </form>

    {% if vehiculo %}

    <!-- Veh√≠culo -->
    <div class="card card-financiera mb-4">
        <div class="card-body">
            <h4 class="mb-3">üöò Datos del Veh√≠culo</h4>
            <div class="row">
                <div class="col-md-3"><strong>Placa:</strong> {{ vehiculo.placa }}</div>
                <div class="col-md-3"><strong>Marca:</strong> {{ vehiculo.marca }}</div>
                <div class="col-md-3"><strong>L√≠nea:</strong> {{ vehiculo.linea }}</div>
                <div class="col-md-3"><strong>Modelo:</strong> {{ vehiculo.modelo }}</div>
            </div>
        </div>
    </div>

    <!-- Propietario -->
    <div class="card card-financiera mb-4">
        <div class="card-body">
            <h4 class="mb-3">üë§ Propietario</h4>
            <p class="mb-1 fs-5">
                {{ user.nombre }} {{ user.p_apellido }} {{ user.s_apellido }}
            </p>
            <p class="text-muted">C√©dula: <strong>{{ user.cedula }}</strong></p>
        </div>
    </div>

    <!-- Cr√©ditos asociados -->
    <div class="card card-financiera">
        <div class="card-body">
            <h4 class="mb-3">üíº Cr√©ditos Asociados</h4>

            <table class="table table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Estado</th>
                        <th>Valor</th>
                        <th class="text-center">Detalle</th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in creditos %}
                    <tr>
                        <td>{{ c.id }}</td>
                        <td>
                            {% if c.estado == 'Activo' %}
                                <span class="badge bg-success">{{ c.estado }}</span>
                            {% elif c.estado == 'En mora' %}
                                <span class="badge bg-warning text-dark">{{ c.estado }}</span>
                            {% elif c.estado == 'Cobro jur√≠dico' %}
                                <span class="badge bg-danger">{{ c.estado }}</span>
                            {% else %}
                                <span class="badge bg-secondary">{{ c.estado }}</span>
                            {% endif %}
                        </td>
                        <td>${{ c.valor_inicial|floatformat:0|intcomma }}</td>
                        <td class="text-center">
                            <a href="{% url 'detalle_credito' c.id %}" class="btn btn-info btn-sm">
                                Ver
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center py-3 text-muted">
                            No tiene cr√©ditos asociados.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>
    </div>

    {% endif %}

</div>

{% endblock %}
