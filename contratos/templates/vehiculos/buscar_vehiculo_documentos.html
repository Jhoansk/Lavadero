{% extends "vehiculos/layout_contratos.html" %}

{% block title %}Buscar Veh√≠culo{% endblock %}

{% block content %}

<div class="container-fluid py-3">

    <!-- HEADER -->
    <div class="mb-4">
        <h2 class="fw-bold">üîç Buscar Veh√≠culo</h2>
    </div>

    <!-- SEARCH -->
    <div class="card p-4 mb-4">

        <form method="post" novalidate>
            {% csrf_token %}

            <div class="row g-3 align-items-end">
                <div class="col-md-4">
                    <label for="placa" class="form-label fw-semibold">
                        Placa del Veh√≠culo
                    </label>
                    <input type="text"
                           name="placa"
                           id="placa"
                           class="form-control"
                           required>
                </div>

                <div class="col-md-3">
                    <button type="submit" class="btn btn-success w-100">
                        üîç Buscar
                    </button>
                </div>
            </div>
        </form>

    </div>

    {% if vehiculo %}
    <!-- VEHICLE INFO -->
    <div class="card p-4 mb-4">

        <h5 class="fw-semibold mb-3">üöò Veh√≠culo Encontrado</h5>

        <div class="row mb-3">
            <div class="col-md-4"><strong>Marca:</strong> {{ vehiculo.marca }}</div>
            <div class="col-md-4"><strong>Modelo:</strong> {{ vehiculo.modelo }}</div>
            <div class="col-md-4"><strong>Color:</strong> {{ vehiculo.color }}</div>
        </div>

        {% if vehiculo.imagen %}
        <div class="mb-3">
            <p class="fw-semibold">üìÑ Tarjeta de Propiedad</p>
            <a href="{{ vehiculo.imagen.url }}" target="_blank"
               class="btn btn-sm btn-outline-primary mb-2">
                Ver Documento
            </a>
            <div class="image-container">
                <img src="{{ vehiculo.imagen.url }}"
                     class="vehiculo-imagen"
                     onclick="showImage(this.src)">
            </div>
        </div>
        {% else %}
            <p class="text-muted">No se ha registrado imagen del veh√≠culo.</p>
        {% endif %}

    </div>

    <!-- DOCUMENTS -->
    <div class="card p-4">

        <h5 class="fw-semibold mb-3">üìÇ Documentos del Veh√≠culo</h5>

        {% if documentos %}
        <div class="row">
            {% for doc in documentos %}
            <div class="col-md-6 mb-4">

                {% if doc.tarjeta_operacion %}
                    <p>
                        Tarjeta de Operaci√≥n:
                        <a href="{{ doc.tarjeta_operacion.url }}" target="_blank">Ver</a>
                    </p>
                {% endif %}

                {% if doc.soat %}
                    <p>SOAT:</p>
                    <img src="{{ doc.soat.url }}"
                         class="document-image"
                         onclick="showImage(this.src)">
                {% endif %}

                {% if doc.tecnomecanica %}
                    <p>Tecnomec√°nica:</p>
                    <img src="{{ doc.tecnomecanica.url }}"
                         class="document-image"
                         onclick="showImage(this.src)">
                {% endif %}

                {% if doc.seguros_rc %}
                    <p>Seguros RC:</p>
                    <img src="{{ doc.seguros_rc.url }}"
                         class="document-image"
                         onclick="showImage(this.src)">
                {% endif %}

            </div>
            {% endfor %}
        </div>
        {% else %}
            <p class="text-muted">No se encontraron documentos para este veh√≠culo.</p>
        {% endif %}

    </div>

    {% elif request.method == "POST" %}
        <div class="alert alert-warning">
            No se encontr√≥ un veh√≠culo con esa placa.
        </div>
    {% endif %}

</div>

<!-- MODAL -->
<div id="modal" class="modal" onclick="this.style.display='none'">
    <img id="modalImage" src="">
</div>

{% endblock %}
