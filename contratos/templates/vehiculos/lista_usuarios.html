{% extends "vehiculos/layout_contratos.html" %}

{% block title %}Lista de Usuarios{% endblock %}

{% block content %}

<div class="container-fluid py-3">

    <!-- T√çTULO + BOT√ìN -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">üë• Lista de Usuarios</h2>
        <a href="{% url 'vehiculos:agregar_usuario' %}" class="btn btn-success">
            ‚ûï Agregar Usuario
        </a>
    </div>

    <!-- TABLA -->
    <div class="card p-3">
        <div class="table-responsive">
            <table class="table table-hover table-striped align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>Nombre</th>
                        <th>Apellido 1</th>
                        <th>Apellido 2</th>
                        <th>C√©dula</th>
                        <th>Tel√©fono</th>
                        <th>Correo</th>
                        <th>Ciudad</th>
                        <th>Barrio</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody>

                {% for usuario in usuarios %}
                    <tr>
                        <td class="fw-bold">{{ usuario.nombre }}</td>
                        <td>{{ usuario.p_apellido }}</td>
                        <td>{{ usuario.s_apellido }}</td>
                        <td>{{ usuario.cedula }}</td>
                        <td>{{ usuario.telefono }}</td>
                        <td>{{ usuario.correo }}</td>
                        <td>{{ usuario.ciudad }}</td>
                        <td>{{ usuario.barrio }}</td>
                        <td class="text-center">

                            <a href="{% url 'vehiculos:editar_usuario' usuario.id %}"
                               class="btn btn-primary btn-sm">
                                ‚úèÔ∏è Editar
                            </a>

                            <form action="{% url 'vehiculos:eliminar_usuario' usuario.id %}"
                                  method="POST"
                                  class="d-inline">
                                {% csrf_token %}
                                <button type="submit"
                                        class="btn btn-danger btn-sm"
                                        onclick="return confirm('¬øSeguro que deseas eliminar este usuario?')">
                                    üóë Eliminar
                                </button>
                            </form>

                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="9" class="text-center text-muted py-3">
                            No hay usuarios registrados.
                        </td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>
        </div>
    </div>

    <!-- PAGINACI√ìN -->
    {% if page_obj.paginator.num_pages > 1 %}
    <div class="d-flex justify-content-center mt-4 gap-2">

        {% if page_obj.has_previous %}
            <a class="btn btn-outline-secondary btn-sm"
               href="?page=1">¬´ Primero</a>

            <a class="btn btn-outline-secondary btn-sm"
               href="?page={{ page_obj.previous_page_number }}">‚Äπ Anterior</a>
        {% endif %}

        <span class="btn btn-light btn-sm disabled">
            P√°gina {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
            <a class="btn btn-outline-secondary btn-sm"
               href="?page={{ page_obj.next_page_number }}">Siguiente ‚Ä∫</a>

            <a class="btn btn-outline-secondary btn-sm"
               href="?page={{ page_obj.paginator.num_pages }}">√öltimo ¬ª</a>
        {% endif %}

    </div>
    {% endif %}

</div>

{% endblock %}
